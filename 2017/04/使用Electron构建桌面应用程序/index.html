<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/blog/favicon.ico?v=5.1.0" />






<meta name="description" content="使用JavaScript，Node.js和Electron 构建您自己的声音机器的详细指南

JavaScript桌面应用程序的用途和用途桌面应用程序总是在我心中有一个特别的地方。自从浏览器和移动设备功能强大以来，桌面应用程序的稳步下降，这些应用程序正在被移动和Web应用程序所取代。尽管如此，编写桌面应用程序仍然有很多优势 - 一旦他们在开始菜单或停靠栏中，它们总是存在，它们是alt（cmd）-">
<meta property="og:type" content="article">
<meta property="og:title" content="使用Electron构建桌面应用程序">
<meta property="og:url" content="https://tomoat.github.io/2017/04/使用Electron构建桌面应用程序/index.html">
<meta property="og:site_name" content="tomoat的笔记">
<meta property="og:description" content="使用JavaScript，Node.js和Electron 构建您自己的声音机器的详细指南

JavaScript桌面应用程序的用途和用途桌面应用程序总是在我心中有一个特别的地方。自从浏览器和移动设备功能强大以来，桌面应用程序的稳步下降，这些应用程序正在被移动和Web应用程序所取代。尽管如此，编写桌面应用程序仍然有很多优势 - 一旦他们在开始菜单或停靠栏中，它们总是存在，它们是alt（cmd）-">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/400/1*GS-t3eNz9Jy7YWKIxxmJPg.png">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/600/1*EJETq7XOPz5RVY5IfF6NIg@2x.png">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/800/1*El4nvvh3h3vjRgwh_wVO7A.png">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/400/1*CsKlT-mLLFJlRoYZnAk9Tg@2x.png">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/800/1*Umzbl_QY7tatF_9Khm400Q@2x.png">
<meta property="og:image" content="https://cdn-images-1.medium.com/max/800/1*VkIt0RY92_fSiZDa9RC6Ng@2x.png">
<meta property="og:updated_time" content="2017-04-08T15:50:01.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用Electron构建桌面应用程序">
<meta name="twitter:description" content="使用JavaScript，Node.js和Electron 构建您自己的声音机器的详细指南

JavaScript桌面应用程序的用途和用途桌面应用程序总是在我心中有一个特别的地方。自从浏览器和移动设备功能强大以来，桌面应用程序的稳步下降，这些应用程序正在被移动和Web应用程序所取代。尽管如此，编写桌面应用程序仍然有很多优势 - 一旦他们在开始菜单或停靠栏中，它们总是存在，它们是alt（cmd）-">
<meta name="twitter:image" content="https://cdn-images-1.medium.com/max/400/1*GS-t3eNz9Jy7YWKIxxmJPg.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://tomoat.github.io/2017/04/使用Electron构建桌面应用程序/"/>





  <title> 使用Electron构建桌面应用程序 | tomoat的笔记 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">tomoat的笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://tomoat.github.io/blog/2017/04/使用Electron构建桌面应用程序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tomoat">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomoat的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                使用Electron构建桌面应用程序
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-08T23:18:21+08:00">
                2017-04-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>使用JavaScript，Node.js和Electron 构建您自己的声音机器的详细指南</p>
</blockquote>
<h3 id="JavaScript桌面应用程序的用途和用途"><a href="#JavaScript桌面应用程序的用途和用途" class="headerlink" title="JavaScript桌面应用程序的用途和用途"></a>JavaScript桌面应用程序的用途和用途</h3><p>桌面应用程序总是在我心中有一个特别的地方。自从浏览器和移动设备功能强大以来，桌面应用程序的稳步下降，这些应用程序正在被移动和Web应用程序所取代。尽管如此，编写桌面应用程序仍然有很多优势 - 一旦他们在开始菜单或停靠栏中，它们总是存在，它们是<em>alt（cmd）-tabbable</em>（我希望这是一个字），并且大多数与底层操作系统（其快捷方式，通知等）比Web应用程序。</p>
<p>在本文中，我将尝试引导您完成构建简单桌面应用程序的过程，并了解如何使用JavaScript构建桌面应用程序的重要概念。</p>
<p><img src="https://cdn-images-1.medium.com/max/400/1*GS-t3eNz9Jy7YWKIxxmJPg.png" alt="img"></p>
<p>​                                        GitHub Electron</p>
<p>使用JavaScript开发桌面应用程序的主要思想是您构建一个代码库，并分别为每个操作系统打包。这样可以消除构建本机桌面应用程序所需的知识，并使维护变得更简单。如今，发展与JavaScript的一个桌面应用程序依赖于任何<a href="http://electron.atom.io/" target="_blank" rel="external">电子</a>或<a href="http://nwjs.io/" target="_blank" rel="external">NW.js</a>。虽然这两种工具提供的功能或多或少相同，但我已经和Electron进行<a href="https://github.com/atom/electron/blob/master/docs/development/atom-shell-vs-node-webkit.md" target="_blank" rel="external">了交流</a>，因为它具有<a href="https://github.com/atom/electron/blob/master/docs/development/atom-shell-vs-node-webkit.md" target="_blank" rel="external">一些重要的优势</a>。在一天结束的时候，你也不会出错。</p>
<h4 id="基本假设"><a href="#基本假设" class="headerlink" title="基本假设"></a>基本假设</h4><p>我假设你已经安装了基本的文本编辑器（或IDE）和<a href="https://nodejs.org/download/" target="_blank" rel="external">Node.js / npm</a>。我也假设你有HTML / CSS / JavaScript的知识（Node.js的CommonJS模块的知识将是巨大的，但并不重要），所以我们可以专注于学习电子概念，而不用担心构建用户界面（其中，事实证明，只是普通的网页）。如果没有，你可能会感到有些失落，我建议您访问<a href="https://medium.com/@bojzi/overview-of-the-javascript-ecosystem-8ec4a0b7a7be" target="_blank" rel="external">我以前的博客帖子</a>来刷新您的基础知识。</p>
<h4 id="电子的10-000英尺视图"><a href="#电子的10-000英尺视图" class="headerlink" title="电子的10,000英尺视图"></a>电子的10,000英尺视图</h4><p>简而言之，Electron提供了使用纯JavaScript构建桌面应用程序的运行时。它的工作原理是 - Electron采用您的<em>package.json</em>文件中定义的<em>主</em>文件并执行它。这个主文件（通常命名为<em>main.js</em>）然后创建包含渲染网页的应用程序窗口，其中增加了与操作系统的本地GUI（图形用户界面）进行交互的功能。<em>**</em></p>
<p>详细来说，一旦您使用Electron启动应用<em>程序，</em>就会创建一个<em>主要的过程</em>。这个<em>主要过程</em>负责与您的操作系统的本机GUI进行交互，并创建应用程序的GUI（您的应用程序窗口）。</p>
<p><img src="https://cdn-images-1.medium.com/max/600/1*EJETq7XOPz5RVY5IfF6NIg@2x.png" alt="img"></p>
<p>纯粹启动的<em>主要过程</em>不会给您的应用<em>程序</em>的用户任何应用程序窗口。这些由主文件中的<em>主进程</em>使用称为<em>BrowserWindow</em>模块的<em>东西创建</em>。然后，每个浏览器窗口运行其自己的<em>渲染器进程</em>。这个<em>渲染器进程</em>需要一个网页（引用通常的CSS文件，JavaScript文件，图像等的HTML文件）并将其呈现在窗口中。您的网页使用<a href="https://www.chromium.org/" target="_blank" rel="external">Chromium</a>呈现，所以与标准保持非常高的兼容性。</p>
<p>例如，如果您只有一个计算器应用程序，您的<em>主要过程</em>将使用实际网页（计算器）的网页实例化一个窗口。</p>
<p>虽然说只有<em>主进程</em>与操作系统的本机GUI进行交互，但是有一些技术可以将一些工作卸载到<em>渲染器进程（</em>我们将研究如何利用这种技术构建一个特性<em>）。</em></p>
<p>的<em>主要过程</em>可以通过一系列模块的访问本地GUI <a href="https://github.com/atom/electron/tree/master/docs/api" target="_blank" rel="external">直接在电子提供</a>。您的桌面应用程序可以访问所有节点模块，如优秀的<a href="https://github.com/mikaelbr/node-notifier" target="_blank" rel="external"><em>节点通知程序</em></a>，以显示系统通知，<a href="https://www.npmjs.com/package/request" target="_blank" rel="external"><em>请求</em></a>进行HTTP呼叫等。</p>
<hr>
<h3 id="你好，世界！"><a href="#你好，世界！" class="headerlink" title="你好，世界！"></a>你好，世界！</h3><p>让我们开始一个传统的问候语，并安装所有必要的先决条件。</p>
<h4 id="随附存储库"><a href="#随附存储库" class="headerlink" title="随附存储库"></a>随附存储库</h4><p>本指南附有<a href="https://github.com/bojzi/sound-machine-electron-guide" target="_blank" rel="external">声音机教程资料库</a>。<br>使用存储库在某些点跟随或继续。克隆存储库以开始：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/bojzi/sound-machine-electron-guide.git</div></pre></td></tr></table></figure>
<p>然后您可以跳转到<em>sound-machine-tutorial</em>文件夹中的git标签：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git checkout &lt;tag-name&gt;</div></pre></td></tr></table></figure>
<p>当代码块的代码可用时，我会通知您：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">跟随：</div><div class="line"> git checkout 00-blank-repository</div></pre></td></tr></table></figure>
<p>克隆/检出您想要的标签后，运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm安装</div></pre></td></tr></table></figure>
<p>以便您没有丢失任何Node模块。</p>
<p>如果您不能切换到另一个标签，最好只需重置存储库状态，然后执行结帐：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git add  - </div><div class="line">git reset --hard</div></pre></td></tr></table></figure>
<h4 id="开设店铺"><a href="#开设店铺" class="headerlink" title="开设店铺"></a>开设店铺</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">跟随标签00-blank-repository：</div><div class="line"> git checkout 00-blank-repository</div></pre></td></tr></table></figure>
<p>在项目文件夹中创建一个新的<em>package.json</em>文件，其中包含以下内容：</p>
<script src="https://gist.github.com/bojzi/8d6d0273a4a196f5e9d7.js"></script>

<p>这个准系统<em>package.json：</em></p>
<ul>
<li>设置应用程序的名称和版本，</li>
<li>让Electron知道<em>主进程</em>将要运行哪个脚本（<em>main.js</em>）和</li>
<li>设置一个有用的快捷方式 - 通过在CLI（终端或命令提示符）中运行“ <em>npm start</em> ”，可轻松运行应用程序的<em>npm</em>脚本。**</li>
</ul>
<p>现在是获得<em>电子</em>的时候了。实现这一目标的最简单方法是通过<em>npm</em>为您的操作系统安装一个预先构建的二进制文件，并将其保存为package.json中的<em>开发依赖关系（</em>由–save <em>-dev自动进行）</em>。在CLI中运行以下命令（在项目文件夹中）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm安装--save-dev电子预制</div></pre></td></tr></table></figure>
<p>预先构建的二进制码是针对正在安装的操作系统而定制的，并允许运行“ <em>npm启动</em> ”。我们正在将其安装为开发依赖关系，因为我们只需要在开发过程中。</p>
<p>也就是说，或多或少地，您开始使用<em>Electron开发</em>所需的一切。</p>
<h4 id="问候世界"><a href="#问候世界" class="headerlink" title="问候世界"></a>问候世界</h4><p>在该文件夹中创建一个<strong>应用程序</strong>文件夹和一个<em>index.html</em>文件，其内容如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>你好， 世界！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在项目的根目录中创建一个<em>main.js</em>文件。这就是Electron的主要进程将会启动并允许创建我们的“Hello，world！”网页的文件。创建具有以下内容的文件：</p>
<script src="https://gist.github.com/bojzi/6c63fb06d0b8b306481c.js"></script>

<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Please update it, I had to do:</span></div><div class="line"><span class="meta"></span></div><div class="line">'use strict';</div><div class="line"></div><div class="line"><span class="keyword">const</span> &#123;app, BrowserWindow&#125; = <span class="built_in">require</span>(<span class="string">'electron'</span>)</div><div class="line"><span class="keyword">let</span> mainWindow = <span class="literal">null</span></div><div class="line"></div><div class="line">app.on(<span class="string">'ready'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    mainWindow = <span class="keyword">new</span> BrowserWindow(&#123;</div><div class="line">        height: <span class="number">600</span>,</div><div class="line">        width: <span class="number">800</span></div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    mainWindow.loadURL(<span class="string">'file://'</span> + __dirname + <span class="string">'/app/index.html'</span>);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// The require line is wrong.</span></div><div class="line"><span class="comment">// It's mainWindow.loadURL, not mainWindow.loadUrl.</span></div><div class="line"><span class="comment">// I'm using Electron 1.3.4.</span></div></pre></td></tr></table></figure>
<p>没什么可怕的吧？<em>应用程序</em>模块控制您<br>的<em>应用程序</em>生命周期（例如 - 响应<em>应用程序</em>的就绪状态）<em>。</em>该<em>BrowserWindow</em>模块允许窗口创建。<br>在<em>主窗口</em>对象将是你的主应用程序窗口，并宣布为<em>无效</em>，因为窗口否则将一次JavaScript的垃圾收集踢关闭。</p>
<p>一旦<em>应用程序</em>获得<em>就绪</em>事件，我们使用<em>BrowserWindow</em>创建一个新的800像素宽和600像素高的窗口。<br>该窗口的<em>渲染器进程</em>将渲染我们的<em>index.html</em>文件。</p>
<p>运行我们的“Hello，World！”应用程序，在您的CLI中运行以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm start</div></pre></td></tr></table></figure>
<p>并沐浴在您的应用程序的荣耀中。</p>
<h3 id="开发一个真正的应用程序"><a href="#开发一个真正的应用程序" class="headerlink" title="开发一个真正的应用程序"></a>开发一个真正的应用程序</h3><h4 id="一台光荣的音响机器"><a href="#一台光荣的音响机器" class="headerlink" title="一台光荣的音响机器"></a>一台光荣的音响机器</h4><p>第一件事 - 首先  <em>是什么声音机器</em>？<br>声音机器是一种小型设备，当您按各种按钮，主要是卡通或反应声音时，会发出声音。这是一个有趣的小工具，以减轻办公室的情绪和一个很好的用例来开发一个桌面应用程序，因为我们将在开发过程中探索很多概念（并获得一个漂亮的声音引导）。</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*El4nvvh3h3vjRgwh_wVO7A.png" alt="img"></p>
<p>我们将要构建的功能和我们将要探索的概念是：</p>
<ul>
<li>基本声音机（基本浏览器窗口实例化），</li>
<li>关闭所述声机（远程消息之间<em>主要</em>和<em>渲染过程），</em></li>
<li>播放声音而不使应用程序焦点（全局键盘快捷键），</li>
<li>创建快捷键修改键（Shift，Ctrl和Alt）的设置屏幕（将用户设置存储在主文件夹中）</li>
<li>添加托盘图标（远程创建本机GUI元素并了解菜单和托盘图标）和</li>
<li>打包您的应用程序（打包您的应用程序为Mac，Windows和Linux）。</li>
</ul>
<hr>
<h3 id="构建声音机的基本功能"><a href="#构建声音机的基本功能" class="headerlink" title="构建声音机的基本功能"></a>构建声音机的基本功能</h3><h4 id="起点和应用组织"><a href="#起点和应用组织" class="headerlink" title="起点和应用组织"></a>起点和应用组织</h4><p>在您的腰带下工作的“Hello，world！”应用程序，现在是开始构建音响机器的时候了。</p>
<p>典型的声音机器具有几行按钮，通过制作声音来响应印刷机。声音主要是卡通和/或反应（笑声，鼓掌，玻璃破碎等）。</p>
<p>这也是我们构建的第一个功能 - 响应点击的基本声音机器。</p>
<p><img src="https://cdn-images-1.medium.com/max/400/1*CsKlT-mLLFJlRoYZnAk9Tg@2x.png" alt="img"></p>
<p>基本文件和文件夹结构</p>
<p>我们的应用程序结构将非常简单。</p>
<p>在应用程序的<strong>根目录</strong>中，我们将保留<em>package.json</em>文件，<em>main.js</em>文件和我们需要的任何其他应用程序范围的文件。</p>
<p>该<strong>应用程序</strong>文件夹会将我们的各种类型的HTML文件放在像<strong>css</strong>，<strong>js</strong>，<strong>wav</strong>和<strong>img</strong>这样的文件夹中。</p>
<p>为了使事情更容易，网页设计所需的所有文件已经被包含在存储库的初始状态中。请检查标签01-start-project。如果您遵循并创建了“Hello，world！”应用程序，则必须重新设置存储库，然后执行checkout：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">If you followed along with the <span class="string">"Hello, world!"</span> example:</div><div class="line">git add -A</div><div class="line">git reset --hard</div><div class="line">Follow along with the tag 01-start-project:</div><div class="line">git checkout 01-start-project</div></pre></td></tr></table></figure>
<p>为了保持简单，我们将只有两个声音，但扩展到完整的16个声音只是一个额外的声音，额外的图标和修改<em>index.html的问题</em>。</p>
<h4 id="定义主要过程的其余部分"><a href="#定义主要过程的其余部分" class="headerlink" title="定义主要过程的其余部分"></a>定义主要过程的其余部分</h4><p>我们再来看看<em>main.js</em>来定义声音机的外观。用以下替换文件的内容：</p>
<script src="https://gist.github.com/bojzi/44b5de344405860026ea.js"></script>

<p>我们通过给它一个维度来定制我们创建的窗口，使其不可调整大小并且无框架。它将看起来像一个真正的声音机悬停在桌面上。</p>
<p>现在的问题是 - 如何移动无框窗口（没有标题栏）并关闭它？<br>我将很快谈论定制窗口（和应用程序）关闭（并介绍一种在<em>主进程</em>和<em>渲染器进程</em>之间进行通信的方式），但拖动部分很容易。如果您查看<em>index.css</em>文件（在<strong>app / css中</strong>），您将看到以下内容：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">html,</div><div class="line">body &#123;</div><div class="line">    ...</div><div class="line">    -webkit-app-region: drag;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>-webkit-app-region：drag; </em>允许整个<em>html</em>是一个可拖动的对象。现在有一个问题，但是您不能单击可拖动对象上的按钮。谜题的另一部分是<em>-webkit-app-region：no-drag; </em>这允许您定义不可破坏（因此可点击的元素）。请考虑以下摘录<em>index.css</em>：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">.button-sound &#123;</div><div class="line">    ...</div><div class="line">    -webkit-app-region: no-drag;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="在自己的窗口中显示声音机"><a href="#在自己的窗口中显示声音机" class="headerlink" title="在自己的窗口中显示声音机"></a>在自己的窗口中显示声音机</h4><p>在<em>main.js</em>现在文件可以使一个新的窗口，并显示机器声音。而且真的，如果您以<em>npm开始</em>启动您的应用<em>程序，</em>您将看到声音机器活着。现在没有什么发生，这并不奇怪，因为我们只有一个静态网页。</p>
<p>将以下内容放在<em>index.js</em>文件中（位于<strong>app / js中</strong>）以获得交互性：</p>
<script src="https://gist.github.com/bojzi/c8d21791c2ab34834aea.js"></script>

<p>这段代码很简单。我们：</p>
<ul>
<li>查询声音按钮，</li>
<li>通过读取<em>数据声音</em>属性的按钮，</li>
<li>为每个按钮添加一个背景图像</li>
<li>并为播放音频的每个按钮添加一个点击事件（使用<a href="https://developer.mozilla.org/en/docs/Web/API/HTMLAudioElement" target="_blank" rel="external">HTMLAudioElement界面</a>）</li>
</ul>
<p>通过在CLI中运行以下命令来测试应用程序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm开始</div></pre></td></tr></table></figure>
<p><img src="https://cdn-images-1.medium.com/max/800/1*Umzbl_QY7tatF_9Khm400Q@2x.png" alt="img">             </p>
<p>​                                    一个工作的声音机！</p>
<h3 id="通过远程事件从浏览器窗口关闭应用程序"><a href="#通过远程事件从浏览器窗口关闭应用程序" class="headerlink" title="通过远程事件从浏览器窗口关闭应用程序"></a>通过远程事件从浏览器窗口关闭应用程序</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Follow along with the tag 02-basic-sound-machine:</span></div><div class="line">git checkout 02-basic-sound-machine</div></pre></td></tr></table></figure>
<p>要重述 - 应用程序窗口（更准确地说，它们的<em>渲染器进程</em>）不应该与GUI进行交互（这就是关闭窗口）。在<a href="https://github.com/atom/electron/blob/master/docs/tutorial/quick-start.md" target="_blank" rel="external">官方电子快速入门指南</a>说：</p>
<blockquote>
<p>在网页中，不允许调用本机GUI相关的API，因为在网页中管理本机GUI资源非常危险，容易泄漏资源。如果要在网页中执行GUI操作，则网页的渲染器进程必须与主进程通信，以请求主进程执行这些操作。</p>
</blockquote>
<p>Electron提供用于该类型通信的<a href="https://github.com/atom/electron/blob/master/docs/api/ipc-renderer.md" target="_blank" rel="external"><em>ipc</em>（进程间通信）模块</a>。<em>ipc</em>允许订阅<em>频道</em>上的消息并向<em>通道的</em>订户发送消息。信道用于区分消息的接收者，并用字符串（例如“channel-1”，“channel-2”…）表示。消息还可以包含数据。收到消息后，用户可以通过做一些工作做出反应，甚至可以回答。消息传递的最大好处是分离问题 - <em>主进程</em>不必知道哪些<em>渲染器进程</em>有哪些或哪个发送消息。</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*VkIt0RY92_fSiZDa9RC6Ng@2x.png" alt="img"></p>
<p>你有邮件。</p>
<p>这正是我们在这里做的 - 将<em>主进程</em>（<em>main.js</em>）订阅到“ <em>关闭主窗口</em> ”通道，并在有人点击关闭按钮时从<em>渲染器进程</em>（<em>index.js</em>）在该<em>通道</em>上发送消息。<em>**</em></p>
<p>将以下内容添加到<em>main.js</em>以订阅频道：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ipc = <span class="built_in">require</span>(<span class="string">'ipc'</span>);</div><div class="line"></div><div class="line">ipc.on(<span class="string">'close-main-window'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    app.quit();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>在要求模块之后，在通道上订阅消息非常简单，并且涉及使用带有通道名和回调函数的<em>on（）</em>方法。</p>
<p>要在该频道上发送消息，请将以下内容添加到<em>index.js中</em>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ipC =  <span class="built_in">require</span>（<span class="string">' ipc '</span>）;</div><div class="line"></div><div class="line"><span class="keyword">var</span> closeEl =  <span class="built_in">document</span>。querySelector（<span class="string">' .close '</span>）;</div><div class="line">closeEl。addEventListener（<span class="string">' click '</span>，<span class="function"><span class="keyword">function</span>（）</span>&#123;</div><div class="line">    ipc。send（<span class="string">' close-main-window '</span>）;</div><div class="line">&#125;）;</div></pre></td></tr></table></figure>
<p>再次，我们需要<em>ipc</em>模块，并使用关闭按钮将<em>点击</em>事件绑定到元素。点击关闭按钮，我们通过<em>send（）</em>方法通过“close-main-window”通道<em>发送消息</em>。</p>
<p>还有一个可能咬你更多的细节和我们已经谈过它- <em>可点击</em>拖动领域。<em>index.css</em>必须将关闭按钮定义为不可拖动。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">.settings &#123;</div><div class="line">    ...</div><div class="line">    -webkit-app-region：no-drag;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>就是这样，我们的应用程序现在可以通过关闭按钮关闭。通过检查事件或传递参数，通过<em>ipc进行通信</em>可能会变得复杂，我们稍后会看到一个传递参数的例子。</p>
<blockquote>
<p><a href="https://medium.com/developers-writing/building-a-desktop-application-with-electron-204203eeb658" target="_blank" rel="external">Building a desktop application with Electron – Developers Writing – Medium</a></p>
</blockquote>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2017/03/JavaScript-中-apply-、call-的详解/" rel="next" title="JavaScript 中 apply 、call 的详解">
                <i class="fa fa-chevron-left"></i> JavaScript 中 apply 、call 的详解
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/blog/images/avatar.gif"
               alt="tomoat" />
          <p class="site-author-name" itemprop="name">tomoat</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/blog/archives">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#JavaScript桌面应用程序的用途和用途"><span class="nav-number">1.</span> <span class="nav-text">JavaScript桌面应用程序的用途和用途</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本假设"><span class="nav-number">1.1.</span> <span class="nav-text">基本假设</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#电子的10-000英尺视图"><span class="nav-number">1.2.</span> <span class="nav-text">电子的10,000英尺视图</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#你好，世界！"><span class="nav-number">2.</span> <span class="nav-text">你好，世界！</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#随附存储库"><span class="nav-number">2.1.</span> <span class="nav-text">随附存储库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#开设店铺"><span class="nav-number">2.2.</span> <span class="nav-text">开设店铺</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#问候世界"><span class="nav-number">2.3.</span> <span class="nav-text">问候世界</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开发一个真正的应用程序"><span class="nav-number">3.</span> <span class="nav-text">开发一个真正的应用程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#一台光荣的音响机器"><span class="nav-number">3.1.</span> <span class="nav-text">一台光荣的音响机器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#构建声音机的基本功能"><span class="nav-number">4.</span> <span class="nav-text">构建声音机的基本功能</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#起点和应用组织"><span class="nav-number">4.1.</span> <span class="nav-text">起点和应用组织</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#定义主要过程的其余部分"><span class="nav-number">4.2.</span> <span class="nav-text">定义主要过程的其余部分</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#在自己的窗口中显示声音机"><span class="nav-number">4.3.</span> <span class="nav-text">在自己的窗口中显示声音机</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过远程事件从浏览器窗口关闭应用程序"><span class="nav-number">5.</span> <span class="nav-text">通过远程事件从浏览器窗口关闭应用程序</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tomoat</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  

  


  

</body>
</html>
